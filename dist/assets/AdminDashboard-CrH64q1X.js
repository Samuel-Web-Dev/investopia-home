import{c as e,u as a,n as s,A as t,r as n,j as r,b as l,B as c,x as i,X as d}from"./index-lCUNTUsE.js";import{C as o,a as m,b as x,d as h}from"./card-CDcdtFEs.js";import{I as v}from"./input-BPSrPAA1.js";import{U as u}from"./users-OKXsTxKZ.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=e("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),p=e("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),g=e("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),N=e("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),f=()=>r.jsx("div",{className:"flex justify-center items-center h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}),y=({setIsAuthenticated:e})=>{const y=a(),{toast:b}=s(),{t:w}=t(),[k,C]=n.useState(!0),[I,D]=n.useState(""),[S,$]=n.useState(null),[B,A]=n.useState(null),[z,E]=n.useState([]);n.useEffect((()=>{(async()=>{try{const e=localStorage.getItem("token"),a=await fetch("https://investpro-h8qu.onrender.com/admin/dashboard",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to fetch data");const s=await a.json();console.log(s),E(s.users)}catch(e){console.error("Error fetching dashboard data:",e)}finally{C(!1)}})()}),[$]);const M=()=>{$(null),A(null)},W=(e,a)=>{if(B)if(e.includes(".")){const[s,t]=e.split(".");A({...B,[s]:{...B[s],[t]:a}})}else A("earningsData"===e?{...B,earningsData:a}:{...B,[e]:a})};return k?r.jsx(f,{}):r.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[r.jsx("nav",{className:"bg-white dark:bg-gray-800 shadow-sm border-b dark:border-gray-700",children:r.jsx("div",{className:"container mx-auto px-4",children:r.jsxs("div",{className:"flex items-center justify-between h-16",children:[r.jsx("div",{className:"flex items-center space-x-4",children:r.jsxs(l,{to:"/admin/dashboard",className:"flex items-center space-x-2 text-primary hover:text-primary/80",children:[r.jsx(j,{className:"w-5 h-5"}),r.jsx("span",{children:w("nav.admin")})]})}),r.jsxs(c,{variant:"ghost",className:"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/10",onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("expiryDate"),e(!1),y("/login")},children:[r.jsx(i,{className:"w-5 h-5 mr-2"}),"Logout"]})]})})}),r.jsxs("div",{className:"container mx-auto px-4 py-8",children:[r.jsxs("div",{className:"mb-8",children:[r.jsxs("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:[w("nav.admin")," 🔐"]}),r.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Manage all investors and their accounts"})]}),r.jsxs(o,{className:"mb-8",children:[r.jsx(m,{children:r.jsx(x,{children:"Search Investors"})}),r.jsx(h,{children:r.jsxs("div",{className:"relative",children:[r.jsx(g,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),r.jsx(v,{placeholder:"Search by username or email...",className:"pl-8",value:I,onChange:e=>D(e.target.value)})]})})]}),r.jsx("div",{className:"grid gap-6",children:z.filter((e=>e.firstName.toLowerCase().includes(I.toLowerCase())||e.email.toLowerCase().includes(I.toLowerCase()))).map((e=>(console.log("Rendering investor:",e._id),r.jsx(o,{className:"hover:shadow-lg transition-all",children:r.jsx(h,{className:"p-6",children:r.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[r.jsxs("div",{className:"space-y-4 flex-1 w-full",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx(u,{className:"w-8 h-8 text-primary"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-semibold",children:e.firstName}),r.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]})]}),S===e._id?r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.totalBalance")}),r.jsx(v,{value:B?.accBalance,onChange:e=>W("accBalance",e.target.value),className:"mt-1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.activeInvestments")}),r.jsx(v,{value:B?.activeInvestments,onChange:e=>W("activeInvestments",e.target.value),className:"mt-1"}),r.jsx(v,{value:B?.accBalance,onChange:e=>W("accBalance",e.target.value),className:"mt-1",placeholder:"Total Value"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.recentDeposit")}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Amount:"}),r.jsx(v,{value:B?.recentDeposit.amount,onChange:e=>W("recentDeposit.amount",e.target.value),className:"flex-1"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Date:"}),r.jsx(v,{value:B?.recentDeposit.date,onChange:e=>W("recentDeposit.date",e.target.value),className:"flex-1",type:"date"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.recentWithdrawal")}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Amount:"}),r.jsx(v,{value:B?.recentWithdrawal.amount,onChange:e=>W("recentWithdrawal.amount",e.target.value),className:"flex-1"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Date:"}),r.jsx(v,{value:B?.recentWithdrawal.date,onChange:e=>W("recentWithdrawal.date",e.target.value),className:"flex-1",type:"date"})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.recentInvestment")}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Amount:"}),r.jsx(v,{value:B?.recentInvestment.amount,onChange:e=>W("recentInvestment.amount",e.target.value),className:"flex-1"})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"text-xs text-gray-500",children:"Date:"}),r.jsx(v,{value:B?.recentInvestment.date,onChange:e=>W("recentInvestment.date",e.target.value),className:"flex-1",type:"date"})]})]})]}),r.jsxs("div",{className:"col-span-2",children:[r.jsx("label",{className:"text-sm font-medium",children:w("dashboard.earningsOverview")}),r.jsx("div",{className:"grid grid-cols-2 gap-2",children:B?.earningsOverview.map(((e,a)=>r.jsxs("div",{className:"flex gap-2",children:[r.jsx(v,{value:e.name,onChange:s=>{const t=[...B.earningsOverview];t[a]={...e,name:s.target.value},W("earningsOverview",t)},placeholder:"Month"}),r.jsx(v,{type:"number",value:e.amount,onChange:s=>{const t=[...B.earningsOverview];t[a]={...e,amount:parseInt(s.target.value)},W("earningsOverview",t)},placeholder:"Amount"})]},a)))})]})]}):r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:w("dashboard.totalBalance")}),r.jsx("p",{className:"text-lg",children:`$${e.accBalance}`})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:w("dashboard.activeInvestments")}),r.jsx("p",{className:"text-lg",children:e.activeInvestments}),r.jsxs("p",{className:"text-sm text-muted-foreground",children:[w("dashboard.totalValue"),": ",`$${e.accBalance}`]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:w("dashboard.recentDeposit")}),r.jsxs("p",{className:"text-lg text-green-500",children:["+",`$${e.recentDeposit.amount}`]}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Date: ",e.recentDeposit.date]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:w("dashboard.recentWithdrawal")}),r.jsxs("p",{className:"text-lg text-red-500",children:["-",`$${e.recentWithdrawal.amount}`]}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Date: ",e.recentWithdrawal.date]})]}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium",children:w("dashboard.recentInvestment")}),r.jsx("p",{className:"text-lg text-blue-500",children:`$${e.recentInvestment.amount}`}),r.jsxs("p",{className:"text-xs text-gray-500",children:["Date: ",e.recentInvestment.date]})]})]})]}),r.jsx("div",{className:"flex items-start space-x-2",children:S===e._id?r.jsxs(r.Fragment,{children:[r.jsx(c,{variant:"outline",size:"icon",onClick:()=>(async e=>{if(!B)return;const a=localStorage.getItem("token");try{const s=await fetch(`https://investpro-h8qu.onrender.com/admin/dashboard/update/${e}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({...B})}),t=await s.json();if(!s.ok)throw new Error(t.message||"Failed to update investor");E(z.map((a=>a._id===e?B:a))),$(null),A(null),b({title:"Success",description:"Investor information updated successfully"})}catch(s){console.error("Error updating investor:",s),b({title:"Error",description:"Failed to update investor",variant:"destructive"})}})(e._id),className:"text-green-600",children:r.jsx(p,{className:"h-4 w-4"})}),r.jsx(c,{variant:"outline",size:"icon",onClick:M,className:"text-red-600",children:r.jsx(d,{className:"h-4 w-4"})})]}):r.jsx(c,{variant:"outline",size:"icon",onClick:a=>{a.stopPropagation(),(async e=>{const a=localStorage.getItem("token"),s=await fetch(`https://investpro-h8qu.onrender.com/admin/dashboard/${e._id}`,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to fetch data");const t=await s.json();console.log(t),$(t.user._id),A({...t.user})})(e)},children:r.jsx(N,{className:"h-4 w-4"})})})]})})},e._id))))})]})]})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{y as default};
